
<!doctype html>
<html lang="zh-TW" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../testing/index.html">
      
      
        <link rel="next" href="../../feature-toggles/main.html">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>03 Creating a Set of Cooperating Microservices - Teddy 的筆記本</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/style.css">
    
      <link rel="stylesheet" href="../../assets/mkdocs_puml/puml.css">
    
      <link rel="stylesheet" href="../../termynal.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#3-creating-a-set-of-cooperating-microservices" class="md-skip">
          跳轉到
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="頁首">
    <a href="../.." title="Teddy 的筆記本" class="md-header__button md-logo" aria-label="Teddy 的筆記本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Teddy 的筆記本
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              03 Creating a Set of Cooperating Microservices
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜尋" placeholder="搜尋" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="搜尋">
        
        <button type="reset" class="md-search__icon md-icon" title="清除" aria-label="清除" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜尋引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="導覽列" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Teddy 的筆記本" class="md-nav__button md-logo" aria-label="Teddy 的筆記本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Teddy 的筆記本
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    JetBrains
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            JetBrains
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/jet-brains/shortcuts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快捷鍵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/jet-brains/postfix-completion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Postfix Completion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vim
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Vim
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/vim/zsh.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    zsh
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/vim/vscode.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VSCode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/vim/ideavim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IdeaVim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/vim/neovim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    neovim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/vim/advanced.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    進階
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/terminal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terminal
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DevOps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            DevOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Terraform
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Terraform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/terraform/backend.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backend
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/terraform/import_infrastructure.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Infrastructure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/terraform/intro_to_terraform.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to Terraform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/terraform/state.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/terraform/style_guide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Style Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/terraform/workspaces.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workspaces
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/apply.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apply
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/pod-topology-spread-constraints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pod Topology Spread Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Domain-Driven Design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Domain-Driven Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/01-crunching-knowledge.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1 Crunching Knowledge
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/02-communication-and-the-use-of-language.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2 Communication and the Use of Language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/03-binding-model-and-implementation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3 Binding Model and Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/04-isolating-the-domain.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4 Isolating the Domain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/05-a-model-expressed-in-software.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5 A Model Expressed in Software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/06-the-life-cycle-of-a-domain-object.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6 The Life Cycle of a Domain Object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/07-using-the-language-an-extended-example.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7 Using the Language - An Extended Example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/08-breakthrough.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8 Breakthrough
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/09-making-implicit-concepts-explicit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9 Making Implicit Concepts Explicit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domain-driven-design/10-supple-design.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10 Supple Design
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Clean Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Clean Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clean-architecture/34.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    34 The Missing Chapter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Java
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Effective Java, 3rd
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Effective Java, 3rd
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Creating And Destroying Objects
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            Creating And Destroying Objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/001.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 1 - Consider static factory methods instead of constructors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/002.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 2 - Consider a builder when faced with many constructor parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/003.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 3 - Enforce the singleton property with a private constructor or an enum type
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/004.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 4 - Enforce noninstantiability with a private constructor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/005.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 5 - Prefer dependency injection to hardwiring resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/006.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 6 - Avoid creating unnecessary objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/007.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 7 - Eliminate obsolete object references
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/008.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 8 - Avoid finalizers and cleaners
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/009.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 9 - Prefer try-with-resources to try-finally
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Methods Common To All Objects
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            Methods Common To All Objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/010.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 10 - Obey the general contract when overriding equals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/011.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 11 - Always override hashCode when you override equals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/012.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 12 = Always override toString
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/013.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 13 - Override clone judiciously
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/014.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 14 - Consider implementing Comparable
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Classes and Interface
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            Classes and Interface
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/015.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 15 - Minimize the accessibility of classes and members
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/016.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 16 - In public classes, use accessor methods, not public fields
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Methods
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/effective-java/055.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Item 55 - Return optionals judiciously
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/pyenv.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pyenv
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Spring Boot
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Spring Boot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Scheduler
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Scheduler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1_1" id="__nav_7_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Quartz
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1_1">
            <span class="md-nav__icon md-icon"></span>
            Quartz
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scheduler/hello_world.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hello World!
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scheduler/jdbc_job_store.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JDBC JobStore
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" checked>
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Microservices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Microservices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    03 Creating a Set of Cooperating Microservices
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="03-creating-a-set-of-cooperating-microservices.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    03 Creating a Set of Cooperating Microservices
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目錄">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目錄
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      參考
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../feature-toggles/main.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Toggles
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kata
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Kata
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kata/Microservices%20with%20Spring%20Boot%203%20and%20Spring%20Cloud%20-%20Third%20Edition/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microservices with Spring Boot 3 and Spring Cloud
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="3-creating-a-set-of-cooperating-microservices">3 Creating a Set of Cooperating Microservices</h1>
<div class='puml-container'><div class="puml light" style="">520. <!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en-US"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en-US"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en-US"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-US"> <!--<![endif]-->
<head>

<title>plantuml.com | 520: Web server is returning an unknown error</title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="robots" content="noindex, nofollow" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" id="cf_styles-css" href="/cdn-cgi/styles/main.css" />
</head>
<body>
<div id="cf-wrapper">
    <div id="cf-error-details" class="p-0">
        <header class="mx-auto pt-10 lg:pt-6 lg:px-8 w-240 lg:w-full mb-8">
            <h1 class="inline-block sm:block sm:mb-2 font-light text-60 lg:text-4xl text-black-dark leading-tight mr-2">
                <span class="inline-block">Web server is returning an unknown error</span>
                <span class="code-label">Error code 520</span>
            </h1>
            <div>
                Visit <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_520&utm_campaign=www.plantuml.com" target="_blank" rel="noopener noreferrer">cloudflare.com</a> for more information.
            </div>
            <div class="mt-3">2025-06-25 18:27:50 UTC</div>
        </header>
        <div class="my-8 bg-gradient-gray">
            <div class="w-240 lg:w-full mx-auto">
                <div class="clearfix md:px-8">
                    <div id="cf-browser-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-browser block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">You</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
  
    Browser
  
  </h3>
  
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
  
</div>
                    <div id="cf-cloudflare-status" class=" relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_520&#38;utm_campaign=www.plantuml.com" target="_blank" rel="noopener noreferrer">
    <span class="cf-icon-cloud block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-ok w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    </a>
  </div>
  <span class="md:block w-full truncate">Ashburn</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
  <a href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_520&utm_campaign=www.plantuml.com" target="_blank" rel="noopener noreferrer">
    Cloudflare
  </a>
  </h3>
  
  <span class="leading-1.3 text-2xl text-green-success">Working</span>
  
</div>
                    <div id="cf-host-status" class="cf-error-source relative w-1/3 md:w-full py-15 md:p-0 md:py-8 md:text-left md:border-solid md:border-0 md:border-b md:border-gray-400 overflow-hidden float-left md:float-none text-center">
  <div class="relative mb-10 md:m-0">
    
    <span class="cf-icon-server block md:hidden h-20 bg-center bg-no-repeat"></span>
    <span class="cf-icon-error w-12 h-12 absolute left-1/2 md:left-auto md:right-0 md:top-0 -ml-6 -bottom-4"></span>
    
  </div>
  <span class="md:block w-full truncate">www.plantuml.com</span>
  <h3 class="md:inline-block mt-3 md:mt-0 text-2xl text-gray-600 font-light leading-1.3">
  
    Host
  
  </h3>
  
  <span class="leading-1.3 text-2xl text-red-error">Error</span>
  
</div>
                </div>
            </div>
        </div>

        <div class="w-240 lg:w-full mx-auto mb-8 lg:px-8">
            <div class="clearfix">
                <div class="w-1/2 md:w-full float-left pr-6 md:pb-10 md:pr-0 leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What happened?</h2>
                    <p>There is an unknown connection issue between Cloudflare and the origin web server. As a result, the web page can not be displayed.</p>
                </div>
                <div class="w-1/2 md:w-full float-left leading-relaxed">
                    <h2 class="text-3xl font-normal leading-1.3 mb-4">What can I do?</h2>
                    
                <h3 class="text-15 font-semibold mb-2">If you are a visitor of this website:</h3>
                <p class="mb-6">Please try again in a few minutes.</p>

                <h3 class="text-15 font-semibold mb-2">If you are the owner of this website:</h3>
                <p><span>There is an issue between Cloudflare's cache and your origin web server. Cloudflare monitors for these errors and automatically investigates the cause. To help support the investigation, you can pull the corresponding error log from your web server and submit it our support team.  Please include the Ray ID (which is at the bottom of this error page).</span> <a rel="noopener noreferrer" href=   "https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/error-520/">Additional troubleshooting resources</a>.</p>
                </div>
            </div>
        </div>

        <div class="cf-error-footer cf-wrapper w-240 lg:w-full py-10 sm:py-4 sm:px-8 mx-auto text-center sm:text-left border-solid border-0 border-t border-gray-300">
    <p class="text-13">
      <span class="cf-footer-item sm:block sm:mb-1">Cloudflare Ray ID: <strong class="font-semibold">9556855a196b1f6d</strong></span>
      <span class="cf-footer-separator sm:hidden">&bull;</span>
      <span id="cf-footer-item-ip" class="cf-footer-item hidden sm:block sm:mb-1">
        Your IP:
        <button type="button" id="cf-footer-ip-reveal" class="cf-footer-ip-reveal-btn">Click to reveal</button>
        <span class="hidden" id="cf-footer-ip">40.69.172.48</span>
        <span class="cf-footer-separator sm:hidden">&bull;</span>
      </span>
      <span class="cf-footer-item sm:block sm:mb-1"><span>Performance &amp; security by</span> <a rel="noopener noreferrer" href="https://www.cloudflare.com/5xx-error-landing?utm_source=errorcode_520&#38;utm_campaign=www.plantuml.com" id="brand_link" target="_blank">Cloudflare</a></span>
      
    </p>
    <script>(function(){function d(){var b=a.getElementById("cf-footer-item-ip"),c=a.getElementById("cf-footer-ip-reveal");b&&"classList"in b&&(b.classList.remove("hidden"),c.addEventListener("click",function(){c.classList.add("hidden");a.getElementById("cf-footer-ip").classList.remove("hidden")}))}var a=document;document.addEventListener&&a.addEventListener("DOMContentLoaded",d)})();</script>
  </div><!-- /.error-footer -->

    </div>
</div>
</body>
</html></div><div class="puml dark" style=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="455px" preserveAspectRatio="xMidYMid meet" style="width:720px;height:455px;background:#1B1B1B;" version="1.1" viewBox="0 0 720 455" width="720px" zoomAndPan="magnify" class="diagram"><defs/><g><rect fill="#1B1B1B" height="455" style="stroke:none;stroke-width:1;" width="720" x="0" y="0"/><g class="cluster" data-entity="product-composite" data-source-line="4" data-uid="ent0002" id="cluster_product-composite"><path d="M145.4834,82.6005 C157.0545,65.0329 169.5923,64.0042 183.5546,79.8781 C194.2714,59.9675 207.0431,61.3144 219.3513,78.3356 C227.8894,62.6402 246.0432,58.7574 256.1687,76.5926 C266.6389,61.9959 283.2801,59.4972 292.9397,77.5066 C304.1196,54.1142 318.9818,56.5372 333.7807,73.878 C346.989,54.1906 364.7758,60.1803 373.7465,78.3515 C382.7611,61.5183 397.3927,59.0223 408.3734,76.3591 C417.6181,59.9007 435.1515,54.6707 446.4493,74.186 C458.6021,54.5134 477.5736,56.6962 489.5526,74.3864 C502.3442,57.698 515.4187,62.5124 523.3605,79.2863 C537.5964,60.8607 550.6258,57.6152 566.9345,76.8906 C580.7142,57.9812 591.6685,61.9103 603.7859,78.611 C616.8724,59.9718 630.65,57.7424 643.1789,79.1594 C655.5207,63.5295 674.7426,62.1558 683.3666,83.23 C684.8487,82.678 685.8,82.9634 685.8536,84.7495 C703.515,95.4609 704.1102,109.2813 689.5978,123.1314 C707.8469,130.0493 712.8538,143.1454 698.8868,158.5197 C713.5931,171.5029 709.8824,189.9342 690.8943,195.6681 C707.9421,213.8559 700.3107,231.9592 676.3666,235.01 C679.3534,235.9363 679.9169,238.3474 678.0592,240.7117 C667.3307,257.4742 651.9537,251.4949 644.8127,236.9072 C634.5349,259.85 616.435,263.5236 601.3922,241.5094 C588.6197,261.5226 571.3398,256.5198 562.4426,237.6295 C553.5771,251.6609 539.2991,251.959 529.4415,238.835 C517.8781,263.5472 498.8644,261.8265 484.9571,241.1313 C475.4599,254.099 460.9871,252.4983 453.202,239.0715 C438.2977,260.2688 422.6554,258.9061 409.5207,237.267 C400.5361,256.5464 383.8092,253.1235 373.7973,238.3446 C361.9676,255.0108 348.2093,256.3362 337.6651,237.0526 C325.9004,254.9074 308.9203,255.0183 297.9299,236.2133 C285.8922,255.5364 271.6755,258.4431 255.8629,240.4713 C241.4255,256.974 226.5642,256.5595 217.0435,235.4032 C207.3156,254.2645 192.1881,255.9513 180.0743,237.7853 C159.1065,258.6141 143.6821,254.2885 132.3666,228.01 C133.5861,227.8123 133.978,228.3539 133.8478,229.4989 C115.8681,219.755 112.8845,205.2744 130.9272,192.6736 C111.8152,186.1007 105.7318,172.7149 120.9419,156.6329 C104.0422,142.3909 111.3994,127.0828 128.7815,120.222 C113.7785,101.7427 113.1038,84.78 139.3666,76.23 C143.8628,75.0784 147.3585,77.6346 145.4834,82.6005" fill="none" style="stroke:#E7E7E7;stroke-width:1;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="148.7979" x="333.4677" y="94.2251">product-composite</text></g><g class="cluster" data-entity="product" data-source-line="27" data-uid="ent0008" id="cluster_product"><path d="M26.643,291.4391 C29.9125,286.6984 34.4431,286.2694 37.2111,291.9478 C40.7299,286.2252 44.9246,286.3415 49.0557,291.2666 C52.1545,286.5923 55.9021,286.165 59.4488,290.7646 C62.487,285.6018 68.1324,284.8617 71.4338,290.4718 C75.4963,286.0633 80.2133,287.4 82.2751,292.7049 C84.8373,288.6768 89.2607,288.6574 91.8497,292.6729 C95.6516,287.3542 100.0206,288.1633 103.4768,293.0662 C111.5411,285.7114 117.4617,289.047 120.3666,298.31 C121.3309,297.7096 122.2688,298.0311 122.4537,299.2194 C129.0745,302.2925 129.4253,306.9386 123.7624,311.3382 C128.3723,314.5828 129.4603,319.404 123.7741,322.6594 C129.4643,324.801 129.5296,328.227 125.8845,332.3927 C132.5748,335.7255 132.2996,339.9408 127.6267,344.8613 C132.6561,347.2967 133.69,350.618 129.1623,354.5656 C135.1713,359.1067 134.4016,363.6444 128.2296,367.2928 C133.1394,371.6925 131.0459,375.4962 125.9497,377.7049 C131.6776,381.3088 130.4397,386.2756 125.5302,389.5013 C129.1832,393.6469 128.2742,397.0687 123.4681,399.4632 C129.7688,411.1586 125.0307,415.8613 113.3666,417.49 C114.4229,417.2317 114.9527,417.9988 114.664,418.9421 C111.7634,424.666 107.1879,425.3494 103.4414,419.7829 C101.3019,424.4777 96.4568,425.8572 93.0444,421.1976 C90.2598,427.1192 85.4648,427.9296 81.0805,422.9539 C79.7859,428.4133 75.7226,430.2567 71.4727,425.8244 C65.941,430.742 61.1733,430.9776 58.4406,422.9964 C54.4017,426.7925 50.6244,427.0749 48.1601,421.3044 C44.2047,425.5344 40.6943,425.1941 37.8687,420.0623 C28.4222,426.0168 18.4003,423.7126 18.3666,410.49 C19.0967,410.1248 19.6667,410.4339 19.7195,411.2594 C14.0677,407.9853 13.4715,404.2051 18.5903,399.8638 C13.1354,397.4756 13.004,392.5242 17.9405,389.4853 C11.7775,386.2646 11.3147,382.5957 16.7867,378.1868 C10.8307,373.6628 11.9507,369.5704 17.4946,365.6983 C12.9612,362.6594 12.9734,359.6925 16.598,355.9067 C11.2722,351.9863 10.9597,348.435 16.5684,344.4862 C10.6316,340.8952 12.0149,336.6382 16.9225,333.3934 C12.39,328.5417 12.091,324.1078 19.2011,321.4836 C14.4917,318.7178 14.0058,314.7629 18.7323,311.5518 C11.5033,302.5091 15.1342,294.6296 25.3666,291.31 C25.8502,290.827 26.2669,290.8595 26.643,291.4391" fill="none" style="stroke:#E7E7E7;stroke-width:1;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="61.5234" x="38.6049" y="309.3051">product</text></g><g class="cluster" data-entity="review" data-source-line="35" data-uid="ent0010" id="cluster_review"><path d="M167.7878,276.7118 C170.83,270.9373 175.1913,270.1014 180.1222,274.3987 C181.1743,268.2641 186.1897,266.8177 190.5179,271.1426 C192.6439,265.9441 196.731,264.8379 200.8423,268.9383 C203.1438,262.659 208.4153,260.4805 213.1777,266.4626 C218.2293,262.8637 222.1098,263.812 223.8653,270.0455 C229.0107,264.4988 232.5366,265.6597 235.5537,272.1177 C238.948,268.1914 243.4078,267.3265 245.9777,273.0118 C256.3919,267.1527 261.2868,270.8679 262.3666,282.01 C262.7896,281.7917 263.062,282.0245 263.0569,282.4612 C269.125,285.3702 270.3617,291.4905 264.6512,295.8067 C270.2287,298.4849 271.0891,304.0721 266.153,308.0409 C272.4791,309.9013 272.2839,314.3716 268.4029,318.4402 C274.8456,322.6634 275.9963,327.6418 268.6675,332.1312 C274.4909,334.0562 275.4352,338.6227 270.4479,342.4186 C276.1281,345.1131 278.1131,351.0205 272.1968,355.2905 C278.3558,359.8098 275.849,365.2005 270.0316,367.616 C276.6138,371.5993 275.3532,376.8834 269.6099,380.4622 C273.9097,385.7826 273.706,389.8176 266.8707,392.6317 C272.5299,396.2565 272.3364,401.863 265.7658,404.3329 C270.811,409.1977 271.1671,413.7049 263.8993,416.7134 C271.1087,425.6793 266.1775,433.8283 255.3666,433.79 C256.2154,433.9977 256.6335,434.8189 255.9264,435.5278 C252.4607,440.4349 248.4926,440.5469 244.9504,435.6131 C243.0064,440.4384 238.8412,442.0993 234.9232,437.7769 C232.518,443.5852 228.9935,444.1529 224.2448,440.392 C221.0698,445.9264 217.5506,446.117 213.3091,441.5461 C208.8388,446.8612 203.9888,444.2632 201.927,438.9634 C198.6447,444.7992 192.6283,445.3612 189.6154,438.6981 C186.4766,443.0104 182.443,442.1702 180.5219,437.4696 C168.6949,442.899 161.4916,441.5581 160.3666,426.79 C160.856,426.8111 160.9242,427.088 160.7416,427.4762 C154.2756,424.4291 153.9907,419.7613 159.7374,415.675 C153.323,413.6373 153.2349,408.5013 157.4197,404.3033 C150.5283,401.9375 150.9485,395.6673 155.7845,391.7713 C149.8364,389.0775 149.0412,383.3056 154.6555,379.5442 C148.004,376.3575 147.971,371.5526 152.59,366.5715 C147.3949,363.5411 146.1582,358.2171 151.8363,354.5073 C147.0078,351.1562 146.9276,346.8724 152.3907,344.0678 C146.0562,339.1351 147.149,333.7583 154.6152,331.2141 C150.0267,326.8294 150.0365,322.3134 156.6273,319.9205 C150.7139,315.7175 152.6075,310.949 157.9938,308.0464 C152.889,303.5228 152.5524,298.0524 159.9711,295.5031 C153.621,287.3303 155.2827,276.5303 167.3666,275.01 C168.4331,275.3383 168.429,275.9609 167.7878,276.7118" fill="none" style="stroke:#E7E7E7;stroke-width:1;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="52.7529" x="184.9902" y="293.0051">review</text></g><g class="cluster" data-entity="recommendation" data-source-line="45" data-uid="ent0012" id="cluster_recommendation"><path d="M311.665,275.99 C314.15,270.7549 318.9829,269.6199 322.9205,274.3492 C326.9311,266.3246 331.6285,266.7731 337.2804,272.6541 C339.9742,265.9134 346.4454,264.9233 350.6565,271.0804 C353.044,265.1002 358.8425,263.2295 363.4784,268.5233 C366.8821,263.3219 372.3733,262.9144 375.5366,268.7851 C378.6662,261.06 383.4103,260.5648 388.7837,266.6297 C394.0101,261.0756 399.0475,261.998 402.9033,268.2665 C407.262,262.9585 413.3378,263.727 416.5207,269.6874 C420.3847,264.8469 426.1354,265.7478 428.218,271.6305 C432.1583,266.3796 438.7486,266.7475 441.8983,272.6044 C447.8221,266.7776 452.9776,267.023 456.003,275.4687 C465.5229,268.9375 471.1867,270.7429 474.3666,282.01 C474.6295,282.1703 474.7349,282.3839 474.4336,282.6074 C482.3622,285.2624 482.003,291.4506 476.5047,296.1578 C482.2211,299.6615 482.6056,303.2492 477.2156,307.452 C482.8213,310.6555 482.6392,314.5475 478.0588,318.5265 C483.9442,322.5315 483.0256,326.141 478.3436,330.3994 C486.3319,332.5639 485.748,338.6492 481.1323,343.4972 C487.1957,346.884 487.3047,351.8827 481.9687,356.0303 C486.7593,359.3601 485.3107,364.5274 480.6524,366.6905 C486.5536,371.2249 487.8705,376.441 480.5008,380.8332 C485.0677,384.3158 484.0364,389.2852 478.6261,390.9121 C483.9278,394.9588 482.8606,401.1364 476.6078,403.3007 C482.3229,406.6458 484.0694,413.1273 477.2264,417.0379 C480.9516,426.6688 478.8605,433.1166 467.3666,433.79 C468.5494,433.5775 469.2348,434.153 468.8567,435.3922 C464.8312,442.0785 458.6658,442.2905 454.6789,435.352 C451.8867,441.4913 446.3251,441.579 442.2716,436.783 C438.7738,443.2968 434.5703,442.8532 430.0248,437.9021 C426.7305,444.6682 422.0781,446.0511 416.9877,439.6854 C413.609,446.1603 407.5839,447.764 402.4505,441.7236 C398.6523,448.4586 392.7557,448.3297 389.3258,441.3705 C385.3896,447.4611 381.2172,446.8688 376.9399,441.7472 C371.6448,447.4703 365.4541,446.2144 362.8424,438.8555 C358.8408,445.2474 353.9453,444.8552 350.4553,438.3636 C346.2531,444.7551 339.7948,444.7126 336.0481,437.8677 C331.2555,443.1214 326.8962,441.1674 324.3548,435.4649 C313.1309,442.9142 305.5011,439.8451 302.3666,426.79 C303.2535,426.3522 303.6155,426.7354 303.7383,427.5967 C298.3509,424.0167 297.9596,419.3992 303.0116,415.2069 C297.4636,412.1686 295.4336,407.7479 301.0514,402.9273 C295.089,399.3474 295.4667,395.0334 300.9305,391.3342 C295.1594,388.2728 294.3588,383.4144 298.9776,378.7417 C293.2843,375.9178 292.3596,370.6423 298.2124,367.062 C292.518,365.5241 290.3218,360.2262 295.3322,355.9209 C289.829,350.6841 290.3262,346.3982 297.5085,343.3592 C292.3099,339.3535 293.123,335.0685 298.2077,331.6783 C292.9391,327.2647 293.2551,322.4198 298.829,318.5181 C293.8252,313.743 293.5999,309.8741 300.5705,306.8929 C295.7408,302.1344 297.1435,298.0459 303.2608,295.9881 C295.5997,286.5247 298.6913,279.1365 309.3666,275.01 C310.527,274.1087 311.4532,274.6667 311.665,275.99" fill="none" style="stroke:#E7E7E7;stroke-width:1;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="133.499" x="321.6171" y="293.0051">recommendation</text></g><g class="entity" data-entity="pc" data-source-line="5" data-uid="ent0003" id="entity_pc"><rect fill="#313139" height="123.7813" rx="2.5" ry="2.5" style="stroke:#E7E7E7;stroke-width:0.5;" width="142.9424" x="139.8966" y="103.23"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.877" x="144.9293" y="121.2251">Product Composite</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="140.8966" x2="281.839" y1="129.5269" y2="129.5269"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.0693" x="145.8966" y="146.522">Product ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.3027" x="145.8966" y="162.8189">Name</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.5947" x="145.8966" y="179.1157">Weight</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130.9424" x="145.8966" y="195.4126">Recommendations</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.873" x="145.8966" y="211.7095">Reviews</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="140.8966" x2="281.839" y1="219.0113" y2="219.0113"/></g><g class="entity" data-entity="RecommendationSummary" data-source-line="12" data-uid="ent0004" id="entity_RecommendationSummary"><rect fill="#313139" height="91.1875" rx="2.5" ry="2.5" style="stroke:#E7E7E7;stroke-width:0.5;" width="197.3037" x="477.7166" y="119.52"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191.3037" x="480.7166" y="137.5151">RecommendationSummary</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="478.7166" x2="674.0203" y1="145.8169" y2="145.8169"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143.0078" x="483.7166" y="162.812">Recommendation ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.1338" x="483.7166" y="179.1089">Author</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.4453" x="483.7166" y="195.4057">Rating</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="478.7166" x2="674.0203" y1="202.7075" y2="202.7075"/></g><g class="entity" data-entity="ReviewSummary" data-source-line="18" data-uid="ent0005" id="entity_ReviewSummary"><rect fill="#313139" height="91.1875" rx="2.5" ry="2.5" style="stroke:#E7E7E7;stroke-width:0.5;" width="124.2344" x="318.2466" y="119.52"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118.2344" x="321.2466" y="137.5151">ReviewSummary</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="319.2466" x2="441.481" y1="145.8169" y2="145.8169"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.9385" x="324.2466" y="162.812">Review ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.1338" x="324.2466" y="179.1089">Author</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.3359" x="324.2466" y="195.4057">Subject</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="319.2466" x2="441.481" y1="202.7075" y2="202.7075"/></g><g class="entity" data-entity="p" data-source-line="28" data-uid="ent0009" id="entity_p"><rect fill="#313139" height="91.1875" rx="2.5" ry="2.5" style="stroke:#E7E7E7;stroke-width:0.5;" width="85.0693" x="26.8366" y="318.31"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.71" x="42.5163" y="336.3051">Product</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="27.8366" x2="110.906" y1="344.6069" y2="344.6069"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.0693" x="32.8366" y="361.602">Product ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.3027" x="32.8366" y="377.8989">Name</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.5947" x="32.8366" y="394.1957">Weight</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="27.8366" x2="110.906" y1="401.4975" y2="401.4975"/></g><g class="entity" data-entity="r" data-source-line="36" data-uid="ent0011" id="entity_r"><rect fill="#313139" height="123.7813" rx="2.5" ry="2.5" style="stroke:#E7E7E7;stroke-width:0.5;" width="85.0693" x="168.8366" y="302.01"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5791" x="186.0817" y="320.0051">Review</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="169.8366" x2="252.906" y1="328.3069" y2="328.3069"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.0693" x="174.8366" y="345.302">Product ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.9385" x="174.8366" y="361.5989">Review ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.1338" x="174.8366" y="377.8957">Author</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.3359" x="174.8366" y="394.1926">Subject</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6787" x="174.8366" y="410.4895">Content</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="169.8366" x2="252.906" y1="417.7913" y2="417.7913"/></g><g class="entity" data-entity="rcd" data-source-line="46" data-uid="ent0013" id="entity_rcd"><rect fill="#313139" height="123.7813" rx="2.5" ry="2.5" style="stroke:#E7E7E7;stroke-width:0.5;" width="155.0078" x="310.8666" y="302.01"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.6484" x="326.5463" y="320.0051">Recommendation</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="311.8666" x2="464.8744" y1="328.3069" y2="328.3069"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.0693" x="316.8666" y="345.302">Product ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143.0078" x="316.8666" y="361.5989">Recommendation ID</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.1338" x="316.8666" y="377.8957">Author</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.4453" x="316.8666" y="394.1926">Rating</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6787" x="316.8666" y="410.4895">Content</text><line style="stroke:#E7E7E7;stroke-width:0.5;" x1="311.8666" x2="464.8744" y1="417.7913" y2="417.7913"/></g><g class="link" data-entity-1="pc" data-entity-2="RecommendationSummary" data-source-line="23" data-uid="lnk6" id="link_pc_RecommendationSummary"><path codeLine="23" d="M243.4466,102.82 C261.2966,75.19 286.3166,45.52 317.8666,30.23 C367.8566,6 391.5966,8.83 442.8666,30.23 C485.8966,48.18 518.5345,82.7091 542.3445,114.2891" fill="none" id="pc-to-RecommendationSummary" style="stroke:#E7E7E7;stroke-width:1;"/><polygon fill="#E7E7E7" points="545.9566,119.08,543.7324,109.4856,542.9465,115.0876,537.3445,114.3018,545.9566,119.08" style="stroke:#E7E7E7;stroke-width:1;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6.5" x="535.086" y="108.2939">*</text></g><g class="link" data-entity-1="pc" data-entity-2="ReviewSummary" data-source-line="24" data-uid="lnk7" id="link_pc_ReviewSummary"><path codeLine="24" d="M283.3266,165.12 C294.8266,165.12 300.3166,165.12 311.8166,165.12" fill="none" id="pc-to-ReviewSummary" style="stroke:#E7E7E7;stroke-width:1;"/><polygon fill="#E7E7E7" points="317.8166,165.12,308.8166,161.12,312.8166,165.12,308.8166,169.12,317.8166,165.12" style="stroke:#E7E7E7;stroke-width:1;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6.5" x="303.8585" y="161.2817">*</text></g><g class="link" data-entity-1="pc" data-entity-2="p" data-source-line="55" data-uid="lnk14" id="link_pc_p"><path codeLine="55" d="M167.2166,227.3 C146.0466,256.64 124.6577,286.2745 105.2677,313.1445" fill="none" id="pc-to-p" style="stroke:#E7E7E7;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#E7E7E7" points="101.7566,318.01,110.2668,313.0525,104.6825,313.9555,103.7795,308.3711,101.7566,318.01" style="stroke:#E7E7E7;stroke-width:1;"/></g><g class="link" data-entity-1="pc" data-entity-2="r" data-source-line="56" data-uid="lnk15" id="link_pc_r"><path codeLine="56" d="M211.3666,227.3 C211.3666,251 211.3666,272.06 211.3666,295.75" fill="none" id="pc-to-r" style="stroke:#E7E7E7;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#E7E7E7" points="211.3666,301.75,215.3666,292.75,211.3666,296.75,207.3666,292.75,211.3666,301.75" style="stroke:#E7E7E7;stroke-width:1;"/></g><g class="link" data-entity-1="pc" data-entity-2="rcd" data-source-line="57" data-uid="lnk16" id="link_pc_rcd"><path codeLine="57" d="M266.3966,227.3 C287.7066,251 308.044,273.5992 329.354,297.2892" fill="none" id="pc-to-rcd" style="stroke:#E7E7E7;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#E7E7E7" points="333.3666,301.75,330.3215,292.3837,330.0228,298.0327,324.3738,297.7339,333.3666,301.75" style="stroke:#E7E7E7;stroke-width:1;"/></g></g></svg></div></div>

<p>對於每個微服務，我們會建立一個 Spring Boot 專案，並有以下設定:</p>
<ul>
<li>使用 Gradle 作為建構工具</li>
<li>產生符合 Java 21 的程式碼</li>
<li>專案會被打包成一個 fat JAR 檔案</li>
<li>引入 <code>Spring Actuator</code> 和 <code>WebFlux</code> 模組的相依套件</li>
<li>基於 Spring Boot v3.4.5（其依賴 Spring Framework v6.2.6）</li>
</ul>
<p>由於這個階段我們尚未建立任何服務註冊機制，我們會將所有微服務都執行在 <code>localhost</code> 上，並為每個微服務使用固定的埠號。我們將使用以下埠號：</p>
<ul>
<li>Product Composite Service: <code>8000</code></li>
<li>Product Service: <code>8001</code></li>
<li>Recommendation Service: <code>8002</code></li>
<li>Review Service: <code>8003</code></li>
</ul>
<details class="tip">
<summary>設定 port</summary>
<div class="highlight"><span class="filename">application.yml</span><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">server.port=8000</span>
</code></pre></div>
</details>
<p><a href="https://start.spring.io/#!type=gradle-project-kotlin&amp;language=kotlin&amp;platformVersion=3.4.5&amp;packaging=jar&amp;jvmVersion=21&amp;groupId=com.example&amp;artifactId=product-service&amp;name=product-service&amp;description=Demo%20project%20for%20Spring%20Boot&amp;packageName=com.example.product-service&amp;dependencies=webflux,actuator">Spring Initializr - Product Service</a><br />
當我們建立好這四個專案後，檔案結構會如下所示:</p>
<div class="highlight"><pre><span></span><code>└ microservices/
    ├── product-composite-service
    ├── product-service
    ├── recommendation-service
    └── review-service
</code></pre></div>
<p>為了讓我們能夠用一個指令就建構所有微服務，我們可以在 Gradle 中設定一個 multi-project build。步驟如下:</p>
<ol>
<li>
<p>首先，我們在根目錄建立 <code>settings.gradle</code> 檔案，用來描述 Gradle 應該建構哪些專案：</p>
<div class="highlight"><pre><span></span><code><span class="n">include</span><span class="p">(</span><span class="s">&quot;:microservices:product-composite-service&quot;</span><span class="p">)</span>
<span class="n">include</span><span class="p">(</span><span class="s">&quot;:microservices:product-service&quot;</span><span class="p">)</span>
<span class="n">include</span><span class="p">(</span><span class="s">&quot;:microservices:recommendation-service&quot;</span><span class="p">)</span>
<span class="n">include</span><span class="p">(</span><span class="s">&quot;:microservices:review-service&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>接著，我們會將其中一個專案中產生的 Gradle 執行檔複製過來，這樣就可以在多專案建構中重複使用它們:</p>
<ul>
<li><code>gradle/</code></li>
<li><code>gradlew</code></li>
<li><code>gradlew.bat</code></li>
<li><code>.gitignore</code></li>
<li><code>.gitattributes</code></li>
</ul>
</li>
<li>
<p>我們不再需要在每個專案中產生的上述檔案，所以可以將它們移除。</p>
</li>
<li>
<p>現在，我們可以用一個指令來建構所有微服務:</p>
<div class="highlight"><pre><span></span><code>./gradlew<span class="w"> </span>build
</code></pre></div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">使用 <code>git add -A</code> 將沒有忽略的檔案加到版控系統</p>
</div>
<p>從 Spring Boot v2.5.0 開始，當執行 <code>./gradlew build</code> 指令時，會產生兩個 JAR 檔案：一個是一般的 JAR 檔案，另一個是只包含編譯後 Java 類別檔的 plain JAR。由於我們不需要這個新的 plain JAR，因此停用了它的建立，這樣就可以使用萬用字元來引用一般的 JAR 來啟動 Spring Boot 應用，例如：</p>
<p><code>java -jar microservices/product-service/build/libs/*.jar</code></p>
<p>為了停用 plain JAR 的建立，我們在每個 microservice 的 <code>build.gradle.kts</code> 檔案中加上以下設定：</p>
<div class="highlight"><span class="filename">build.gradle.kts</span><pre><span></span><code>tasks.named(&quot;jar&quot;) {
    enabled = false
}
</code></pre></div>
<p>Product Service cases</p>
<table>
<thead>
<tr>
<th>Request</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET /products/1</td>
<td>OK</td>
</tr>
<tr>
<td>GET /products/not-integer</td>
<td>BAD_REQUEST (<code>Type mismatch.</code>) <sup id="fnref4:1"><a class="footnote-ref" href="#fn:1">1</a></sup></td>
</tr>
<tr>
<td>GET /products/13</td>
<td>NOT_FOUND (<code>Product (id: 13) not found.</code>)</td>
</tr>
<tr>
<td>GET /products/-1</td>
<td>UNPROCESSABLE_ENTITY (<code>Invalid product id: -1.</code>)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>錯誤的訊息，必須包含兩個欄位 <code>path</code>, <code>message</code></p>
</div>
<details class="tip">
<summary>撰寫 HTTP request 測試</summary>
<ul>
<li><code>@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)</code></li>
<li><code>@Autowired private lateinit var webTestClient: WebTestClient</code></li>
<li>test code<br />
    <div class="highlight"><pre><span></span><code><span class="n">webTestClient</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">uri</span><span class="p">(</span><span class="s">&quot;/products/1&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">exchange</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="na">expectStatus</span><span class="p">().</span><span class="na">isOk</span>
<span class="w">    </span><span class="p">.</span><span class="na">expectBody</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="na">jsonPath</span><span class="p">(</span><span class="s">&quot;</span><span class="err">$</span><span class="s">.id&quot;</span><span class="p">).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">jsonPath</span><span class="p">(</span><span class="s">&quot;</span><span class="err">$</span><span class="s">.name&quot;</span><span class="p">).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="s">&quot;Product 1&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">jsonPath</span><span class="p">(</span><span class="s">&quot;</span><span class="err">$</span><span class="s">.weight&quot;</span><span class="p">).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
</code></pre></div></li>
</ul>
</details>
<details class="tip">
<summary>Global Exception Handler</summary>
<ol>
<li>
<p>新增 Global Exception Handler 的類別</p>
</li>
<li>
<p>在類別標上 <code>@RestControllerAdvice</code></p>
</li>
<li>
<p>在類別中新增處理例外的 function</p>
<ul>
<li>假設處理 <code>NotFoundException</code>，則在 function 標上 <code>@ExceptionHandler(NotFoundException::class)</code></li>
<li>假設回傳的 http status 是 not found，則在 function 標上 <code>@ResponseStatus(HttpStatus.NOT_FOUND)</code></li>
</ul>
</li>
<li>
<p>function 接受處理的例外當作參數。</p>
<ul>
<li>例如 <code>fun handleNotFound(e: NotFoundException)</code></li>
</ul>
</li>
<li>
<p>function 接受 <code>ServerHttpRequest</code> 當作參數，用以取得 path</p>
<ul>
<li>例如 <code>fun handleNotFound(.., request: ServerHttpRequest)</code></li>
<li>path 為 <code>request.path.pathWithinApplication().value()</code></li>
</ul>
</li>
<li>
<p>宣告類別用以表達回傳的資料。</p>
<div class="highlight"><pre><span></span><code><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Response</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">path</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">message</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</li>
</ol>
</details>
<p>Recommendation service cases</p>
<table>
<thead>
<tr>
<th>Request</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET /recommendations?productId=1</td>
<td>OK, 3 筆 recommendations</td>
</tr>
<tr>
<td>GET /recommendations</td>
<td>BAD_REQUEST (<code>Required query parameter 'productId' is not present.</code>) <sup id="fnref3:1"><a class="footnote-ref" href="#fn:1">1</a></sup></td>
</tr>
<tr>
<td>GET /recommendations?productId=not-integer</td>
<td>BAD_REQUEST (<code>Type mismatch.</code>)</td>
</tr>
<tr>
<td>GET /recommendations?productId=113</td>
<td>OK, empty</td>
</tr>
<tr>
<td>GET /recommendations?productId=-1</td>
<td>UNPROCESSABLE_ENTITY (<code>Invalid productId: -1.</code>)</td>
</tr>
</tbody>
</table>
<details class="tip">
<summary>實作提示</summary>
<ul>
<li>
<p>驗證 json 內容</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Test</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">`get recommendations`</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">webTestClient</span>
<span class="w">        </span><span class="p">.</span><span class="na">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">uri</span><span class="p">(</span><span class="s">&quot;/recommendations?productId=1&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">exchange</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">expectStatus</span><span class="p">().</span><span class="na">isOk</span>
<span class="w">        </span><span class="p">.</span><span class="na">expectHeader</span><span class="p">().</span><span class="na">contentType</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">expectBody</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">json</span><span class="p">(</span>
<span class="w">            </span><span class="s">&quot;&quot;&quot;[</span>
<span class="s">            { &quot;id&quot;: 1, &quot;productId&quot;: 1, &quot;content&quot;: &quot;recommendation 1&quot;, &quot;author&quot;: &quot;author 1&quot;, &quot;rating&quot;: 4.5 },</span>
<span class="s">            { &quot;id&quot;: 2, &quot;productId&quot;: 1, &quot;content&quot;: &quot;recommendation 2&quot;, &quot;author&quot;: &quot;author 2&quot;, &quot;rating&quot;: 3.0 },</span>
<span class="s">            { &quot;id&quot;: 3, &quot;productId&quot;: 1, &quot;content&quot;: &quot;recommendation 3&quot;, &quot;author&quot;: &quot;author 3&quot;, &quot;rating&quot;: 5.0 }</span>
<span class="s">        ]&quot;&quot;&quot;</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Json 預設比對是寬鬆模式 (LENIENT)，field 順序不重要，實際上有多的 field 沒有 assert 也不重要。</p>
</li>
<li>
<p>Query parameter: <code>@RequestParam</code></p>
</li>
<li>
<p>使用 jsonPath 驗證 list 的長度</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Test</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">`empty recommendation`</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">webTestClient</span>
<span class="w">        </span><span class="p">.</span><span class="na">get</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">uri</span><span class="p">(</span><span class="s">&quot;/recommendation?productId=113&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">exchange</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">expectStatus</span><span class="p">().</span><span class="na">isOk</span>
<span class="w">        </span><span class="p">.</span><span class="na">expectHeader</span><span class="p">().</span><span class="na">contentType</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">expectBody</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">jsonPath</span><span class="p">(</span><span class="s">&quot;</span><span class="err">$</span><span class="s">.length()&quot;</span><span class="p">).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</li>
</ul>
</details>
<div class="admonition note">
<p class="admonition-title">重構</p>
<ul>
<li>
<p>新增 <code>util</code> module</p>
<ul>
<li>新增純 gradle 專案，不必是 spring boot</li>
<li>
<p>設定 <code>build.gradle.kts</code></p>
<div class="highlight"><span class="filename">build.gradle.kts</span><pre><span></span><code><span class="n">plugins</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">kotlin</span><span class="p">(</span><span class="s">&quot;jvm&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;2.0.21&quot;</span>
<span class="w">    </span><span class="n">kotlin</span><span class="p">(</span><span class="s">&quot;plugin.spring&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;1.9.25&quot;</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="n">dependencies</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">platform</span><span class="p">(</span><span class="s">&quot;org.springframework.boot:spring-boot-dependencies:3.4.5&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.springframework:spring-context&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.springframework:spring-webflux&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="n">kotlin</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>設定 Auto-Configuration，讓相依此 module 的 project，可以自動掃描 <code>util</code> 定義的 beans</p>
<div class="highlight"><span class="filename">UtilConfiguration.kt</span><pre><span></span><code><span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="p">(</span><span class="s">&quot;org.example.util&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// 這裡填入 util 的 base package，以掃描在此 package 下的所有 bean</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UtilConfiguration</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">resources/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</span><pre><span></span><code>org.example.exception.UtilConfiguration
</code></pre></div>
</li>
<li>
<p>將例外移到 <code>util</code> module 共用</p>
</li>
<li>將 Global Exception Handler 移到 <code>util</code> module 共用</li>
</ul>
</div>
<p>Review service cases</p>
<table>
<thead>
<tr>
<th>Request</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET /reviews?productId=1</td>
<td>OK, 3 筆 reviews</td>
</tr>
<tr>
<td>GET /reviews</td>
<td>BAD_REQUEST (<code>Required query parameter 'productId' is not present.</code>) <sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">1</a></sup></td>
</tr>
<tr>
<td>GET /reviews?productId=no-integer</td>
<td>BAD_REQUEST (<code>Type mismatch.</code>) <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></td>
</tr>
<tr>
<td>GET /reviews?productId=213</td>
<td>OK, empty</td>
</tr>
<tr>
<td>GET /reviews?productId=-1</td>
<td>UNPROCESSABLE_ENTITY (<code>Invalid productId: -1.</code>)</td>
</tr>
</tbody>
</table>
<p>Product Composite service</p>
<table>
<thead>
<tr>
<th>Request</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET /product-composite/1</td>
<td>OK, length(reviews) = 1, length(recommendations) = 1</td>
</tr>
<tr>
<td>GET /product-composite/2</td>
<td>NOT_FOUND (<code>Not found productId: 2.</code>)</td>
</tr>
<tr>
<td>GET /product-composite/-1</td>
<td>UNPROCESSABLE_ENTITY (<code>Invalid productId: -1.</code>)</td>
</tr>
</tbody>
</table>
<ul>
<li>使用假資料，<code>productId=1</code> 時，reviews, recommendations 各一筆</li>
</ul>
<div class="admonition note">
<p class="admonition-title">重構</p>
<ul>
<li>提取 <code>ProductService</code>, <code>RecommendationService</code>, <code>ReviewService</code> 成 interface</li>
<li>新增 <code>api</code> module，將 service interface 放在這個 module 中</li>
</ul>
</div>
<details class="tip">
<summary>測試</summary>
<ul>
<li>使用 <a href="https://wiremock.org/docs/spring-boot/">WireMock</a><ul>
<li><code>testImplementation("org.wiremock.integrations:wiremock-spring-boot:3.6.0")</code></li>
<li>在測試標上 <code>@EnableWireMock</code><br />
    <div class="highlight"><pre><span></span><code><span class="c1">// ...</span>
<span class="nd">@EnableWireMock</span><span class="p">(</span><span class="n">ConfigureWireMock</span><span class="p">(</span><span class="n">baseUrlProperties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s">&quot;product-service.host&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;review-service.host&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;recommendation-service.host&quot;</span><span class="o">]</span><span class="p">))</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ProductCompositeServiceApplicationTests</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></li>
<li>用 <code>subFor</code> 來 mock api 回傳的資料<br />
    <div class="highlight"><pre><span></span><code><span class="n">stubFor</span><span class="p">(</span><span class="k">get</span><span class="p">(</span><span class="s">&quot;/product/1&quot;</span><span class="p">).</span><span class="na">willReturn</span><span class="p">(</span><span class="n">okJson</span><span class="p">(</span><span class="s">&quot;{\&quot;id\&quot;: 1, \&quot;name\&quot;: \&quot;Product 1\&quot;, \&quot;weight\&quot;: 123}&quot;</span><span class="p">)))</span>
<span class="n">stubFor</span><span class="p">(</span><span class="k">get</span><span class="p">(</span><span class="s">&quot;/review?productId=1&quot;</span><span class="p">).</span><span class="na">willReturn</span><span class="p">(</span><span class="n">okJson</span><span class="p">(</span><span class="s">&quot;[{\&quot;id\&quot;: 1, \&quot;productId\&quot;: 1, \&quot;author\&quot;: \&quot;Author 1\&quot;, \&quot;subject\&quot;: \&quot;Subject 1\&quot;, \&quot;content\&quot;: \&quot;Content 1\&quot;}]&quot;</span><span class="p">)))</span>
<span class="n">stubFor</span><span class="p">(</span><span class="k">get</span><span class="p">(</span><span class="s">&quot;/recommendation?productId=1&quot;</span><span class="p">).</span><span class="na">willReturn</span><span class="p">(</span><span class="n">okJson</span><span class="p">(</span><span class="s">&quot;[{\&quot;id\&quot;: 1, \&quot;productId\&quot;: 1, \&quot;author\&quot;: \&quot;Author 1\&quot;, \&quot;rating\&quot;: 4.2, \&quot;content\&quot;: \&quot;Content 1\&quot;}]&quot;</span><span class="p">)))</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</details>
<details class="tip">
<summary>實作 service client</summary>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nc">ProductServiceClient</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ProductService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@GetExchange</span><span class="p">(</span><span class="s">&quot;/product/{productId}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getProduct</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">productId</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">):</span><span class="w"> </span><span class="n">Product</span>
<span class="p">}</span>

<span class="nd">@Bean</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">productServiceClient</span><span class="p">(</span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;\</span><span class="si">${</span><span class="n">product</span><span class="o">-</span><span class="n">service</span><span class="p">.</span><span class="na">host</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">ProductServiceClient</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">webClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WebClient</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">baseUrl</span><span class="p">(</span><span class="n">host</span><span class="p">).</span><span class="na">build</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WebClientAdapter</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">webClient</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpServiceProxyFactory</span><span class="p">.</span><span class="na">builderFor</span><span class="p">(</span><span class="n">adapter</span><span class="p">).</span><span class="na">build</span><span class="p">()</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">factory</span><span class="p">.</span><span class="na">createClient</span><span class="p">(</span><span class="n">ProductServiceClient</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li><code>WebClient</code> 才有支援 suspend，<code>RestTemplate</code>, <code>RestClient</code> 如果要產生 suspend method 的 API，在呼叫時，會拋出錯誤。</li>
</ul>
<p>參考: <a href="https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-http-interface">https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-http-interface</a></p>
</details>
<p>半自動 Integration tests</p>
<table>
<thead>
<tr>
<th>Request</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET /product-composite/1</td>
<td>len(reviews) = 3 &amp;&amp; len(recommendations) = 3</td>
</tr>
<tr>
<td>GET /product-composite/13</td>
<td>404 (<code>Product (id: 13) not found.</code>)</td>
</tr>
<tr>
<td>GET /product-composite/113</td>
<td>len(reviews) = 3 &amp;&amp; len(recommendations) = 0</td>
</tr>
<tr>
<td>GET /product-composite/213</td>
<td>len(reviews) = 0 &amp;&amp; len(recommendations) = 3</td>
</tr>
</tbody>
</table>
<details class="tip">
<summary>Tip</summary>
<ul>
<li>
<p>建立新的專案 integration-tests</p>
<div class="highlight"><span class="filename">build.gradle.kts</span><pre><span></span><code><span class="n">plugins</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">kotlin</span><span class="p">(</span><span class="s">&quot;jvm&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;2.0.21&quot;</span>
<span class="w">    </span><span class="n">kotlin</span><span class="p">(</span><span class="s">&quot;plugin.spring&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;1.9.25&quot;</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="n">dependencies</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">platform</span><span class="p">(</span><span class="s">&quot;org.springframework.boot:spring-boot-dependencies:3.4.5&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.springframework:spring-webflux&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="n">kotlin</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="s">&quot;org.springframework.boot:spring-boot-starter-test&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">testRuntimeOnly</span><span class="p">(</span><span class="s">&quot;org.junit.platform:junit-platform-launcher&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p><code>webTestClient = WebTestClient.bindToServer().baseUrl("http://localhost:8000").build()</code></p>
</li>
<li>
<p>手動啟動所有 microservices 後再執行測試</p>
</li>
</ul>
</details>
<h2 id="_1">參考</h2>
<p><a href="https://github.com/PacktPublishing/Microservices-with-Spring-Boot-and-Spring-Cloud-Third-Edition/tree/main/Chapter03">https://github.com/PacktPublishing/Microservices-with-Spring-Boot-and-Spring-Cloud-Third-Edition/tree/main/Chapter03</a></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>在 properties 檔案新增 <code>server.error.include-message=always</code> 將會在 response 中提供 <code>message</code>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最後更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2025年6月25日 18:27:14 UTC">2025年6月25日</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="建立日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2025年6月2日 07:48:11 UTC">2025年6月2日</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到頂端
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024-2025 Teddy Lee
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.select", "content.code.annotate", "content.code.copy", "toc.integrate", "navigation.top", "content.footnote.tooltips", "content.tooltips"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u8907\u88fd", "clipboard.copy": "\u8907\u88fd", "search.result.more.one": "\u6b64\u9801\u5c1a\u6709 1 \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.more.other": "\u6b64\u9801\u5c1a\u6709 # \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.none": "\u6c92\u6709\u7b26\u5408\u7684\u9805\u76ee", "search.result.one": "\u627e\u5230 1 \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.other": "\u627e\u5230 # \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.placeholder": "\u6253\u5b57\u9032\u884c\u641c\u5c0b", "search.result.term.missing": "\u7f3a\u5c11\u5b57\u8a5e", "select.version": "\u9078\u64c7\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../assets/mkdocs_puml/puml.js"></script>
      
        <script src="../../termynal.js"></script>
      
    
  </body>
</html>